---
layout: default
permalink: /itinerary.html
---

<!-- 行程样式：淡紫色主题 -->
<link rel="stylesheet" href="/assets/css/itinerary.css">

<div id="password-screen">
  <div class="pw-box card">
    <h2>请输入访问密码</h2>
    <input type="password" id="pw-input" placeholder="请输入密码">
    <button onclick="checkPassword()">进入行程</button>
    <p id="pw-error" class="error"></p>
  </div>
</div>

<div id="content-wrap" style="display:none">
  <div class="container itinerary-page">

    <!-- 标题信息 -->
    <div class="card mb-4">
      <h1 class="main-title">{{ itinerary.basic.title }}</h1>
      <p class="sub-title"><strong>客户姓名：</strong>{{ itinerary.basic.client_name }}（{{ itinerary.basic.travelers }}人）</p>
      <p class="sub-title"><strong>行程日期：</strong>{{ itinerary.basic.start_date }} 至 {{ itinerary.basic.end_date }}</p>
    </div>

    <!-- 参团 / 离团 信息 -->
    {% if itinerary.options.show_join_leave %}
    <div class="card mb-4">
      <h2>参团与离团信息</h2>

      <h3>上团信息</h3>
      <p><strong>上团地点：</strong>{{ itinerary.join_info.join_city }}</p>
      <p><strong>上团日期：</strong>{{ itinerary.join_info.join_date }}；{{ itinerary.join_info.join_note }}</p>
      <p><strong>航班信息：</strong>{{ itinerary.join_info.join_flight }}</p>

      <h3 class="mt-3">下团信息</h3>
      <p><strong>下团地点：</strong>{{ itinerary.leave_info.leave_city }}</p>
      <p><strong>下团日期：</strong>{{ itinerary.leave_info.leave_date }}；{{ itinerary.leave_info.leave_note }}</p>
      <p><strong>航班信息：</strong>{{ itinerary.leave_info.leave_flight }}</p>

      {% if itinerary.important_note %}
      <p class="important-note">{{ itinerary.important_note }}</p>
      {% endif %}
    </div>
    {% endif %}

    <!-- 每日行程 -->
    {% if itinerary.options.show_daily %}
    <div class="card mb-4">
      <h2>每日行程安排</h2>

      {% for d in itinerary.daily_itinerary %}
      <div class="day-block">
        <h3>第{{ d.day }}天 ｜ {{ d.date }} ｜ {{ d.weekday }}</h3>
        <h4>{{ d.title }}</h4>
        <p>{{ d.content | newline_to_br }}</p>

        {% if d.hotel %}
        <p><strong>夜宿：</strong>{{ d.hotel.name }}</p>
        <p><strong>地址：</strong>{{ d.hotel.address }}</p>
        {% endif %}
      </div>
      {% if forloop.last == false %}
      <hr>
      {% endif %}
      {% endfor %}
    </div>
    {% endif %}

    <!-- 费用信息 -->
    {% if itinerary.options.show_expense %}
    <div class="card mb-4">
      <h2>费用信息</h2>

      <h3>已含费用</h3>
      <ul>
        {% for i in itinerary.expense.included %}
        <li>{{ i }}</li>
        {% endfor %}
      </ul>

      <h3>不含费用</h3>
      <ul>
        {% for i in itinerary.expense.excluded %}
        <li>{{ i }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

  </div>
</div>

<!-- JS：动态加载行程 + 密码验证 -->
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const clientID = urlParams.get('client');

  // 未带 client 参数 → 跳首页
  if (!clientID) window.location.href = "/";

  // 加载所有 itinerary 数据
  const itineraryData = {{ site.data.itineraries | jsonify }};
  const itinerary = itineraryData[clientID];

  // client 不存在 → 跳首页
  if (!itinerary) window.location.href = "/";

  // 密码验证
  function checkPassword() {
    const input = document.getElementById("pw-input").value;
    if (input === itinerary.password) {
      document.getElementById("password-screen").style.display = "none";
      document.getElementById("content-wrap").style.display = "block";
    } else {
      document.getElementById("pw-error").textContent = "密码错误，请重试";
    }
  }
</script>
